import { EVENT_ID_INFO } from "./eventid.dictionary.js";

export function analyzeEventIds(events) {
	const counter = {};

	for (const e of events) {
		if (!e.event_id) continue;

		counter[e.event_id] = (counter[e.event_id] || 0) + 1;
	}

	const results = [];

	for (const [eventId, count] of Object.entries(counter)) {
		const info = EVENT_ID_INFO[eventId];

		results.push({
			event_id: Number(eventId),
			count,
			title: info?.title || "Unknown Windows Event",
			category: info?.category || "Unknown",
			explanation:
				info?.explanation ||
				"This event is generated by Windows. Repeated occurrences may require further investigation.",
		});
	}

	// Sort by most frequent first
	results.sort((a, b) => b.count - a.count);

	return results;
}
